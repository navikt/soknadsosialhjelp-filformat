{
  "$schema": "http://json-schema.org/draft-06/schema#",

  "definitions": {    
    "soknad": {
      "type": "object",
      "title": "JSON-formatert søknad om sosialhjelp.",
      "properties": {
      
      	"version": {
      	  "title": "Søknadsdataversjonen.",
      	  "description": "Versjonsnummeret følger regler som tar utgangspunkt i \"https://semver.org/\". Ny majorversjon betyr en ny søknadsfil. Ny minorversjon betyr at feltet \"kompatibilitet\" kan ha blitt brukt. Ny pathversjon brukes kun til mindre feilrettinger.",
          "type": "string",
          "pattern": "^[0-9]+\\.[0-9]+\\.[0-9]+(\\+[a-zA-Z0-9]+)?$",
          "default": "1.0.0"
        },
        
        "data": {
          "title": "Inneholder søknadsdataene uten meta- og kompatibilitetsdata.",
          "type": "object",
          "properties": {
          
            "personalia": {
              "title": "Søknadsdata som er knyttet til søker.",
              "type": "object",
              "properties": {
              	"personIdentifikator": {
					"$ref": "personalia/personIdentifikator.json"
	            },
	            "navn" : {
	              "$ref": "personalia/sokernavn.json"
	            },
	            "nordiskBorger": {
	              "$ref": "personalia/nordiskBorger.json"
	            },
	            "telefonnummer": {
	              "$ref": "personalia/telefonnummer.json"
	            },
	            "kontonummer": {
	              "$ref": "personalia/kontonummer.json"
	            },
	            "folkeregistrertAdresse": {
	              "$ref": "parts/adresse.json"
	            },
	            "oppholdsadresse": {
	              "$ref": "parts/adresse.json"
	            },
	            "postAdresse": {
	              "$ref": "parts/adresse.json"
	            }
              },
              "required": [
                "personIdentifikator", "navn"
      	      ]
            },
            
            "arbeid": {
              "type": "object",
              "properties": {
                "forhold": {
                  "type": "array",
                  "items": {
					"$ref": "arbeid/forhold.json"
			      }
                },
                "situasjon": {
				  "$ref": "arbeid/situasjon.json"
			    },
			    "kommentarTilArbeidsforhold": {
			      "type": "object",
			      "properties": {
			        "kilde": {
	              	  "$ref": "parts/kildeBruker.json"
			        },
			        "verdi": {
			          "type": "string"
			        }
			      }
				}
              },
              "dependencies": {
                "kommentarTilArbeidsforhold": ["forhold"]
              }
            },
            
            "utdanning": {
              "type": "object",
              "properties": {
                "kilde": {
	              "$ref": "parts/kildeBruker.json"
			    },
			    "erStudent": {
			      "type": "boolean"
			    },
			    "studentgrad": {
			      "type": "string"
			    }
			  }
			},
			
			"familie": {
			  "type": "object",
			  "properties": {
			    "sivilstatus": {
			      "$ref": "familie/sivilstatus.json"
		        },
		        "folkeregistrertMedEktefelleAvviksforklaring": {
		          "$ref": "familie/folkeregistrertMedEktefelleAvviksforklaring.json"
		        },
		        "forsorgerplikt": {
		          "type": "object",
		          "properties": {
		          	"harForsorgeransvar": {
					  "$ref": "familie/harForsorgeransvar.json"
		          	},
		          	"ansvar": {
		          	  "type": "array",
		          	  "items": {
		          	    "type": "object",
		          	    "properties": {
			          	  "barn": {
							"$ref": "familie/barn.json"
		          	      },
		          	      "borSammenMed": {
							"$ref": "familie/borSammenMed.json"
		          	      },
		          	      "erFolkeregistrertSammen": {
		          	      	"$ref": "familie/erFolkeregistrertSammen.json"
		          	      },
		          	      "samvarsgrad": {
		          	        "$ref": "familie/samvarsgrad.json"
		          	      }
			        	}
		          	  }
		          	}
		          }
		        }
		      },
		      "dependencies": {
		        "folkeregistrertMedEktefelleAvviksforklaring": {
		          "properties": {
		            "sivilstatus": {
		              "properties": {
		                "kilde": {
		                  "enum": [ "system"]
		                }
		              },
		              "required": ["kilde"]
		            }
		          },
		          "required": ["sivilstatus"]
		        }
		      }
			},
			
			"begrunnelse": {
			  "type": "object",
			  "properties": {
		  	    "kilde": {
	              "$ref": "parts/kildeBruker.json"
			    },
			    "hvorforSoke": {
			      "type": "string"
			    },
			    "hvaSokesOm": {
			      "type": "string"
			    }
			  }
			},
			
			"bosituasjon": {
			  "type": "object",
			  "properties": {
			    "kilde": {
	              "$ref": "parts/kildeBruker.json"
			    },
			    "botype": {
			      "type": "string"
			    },
			    "annenSituasjon": {
			      "type": "string"
			    },
			    "antallPersoner": {
			      "type": "number"
			    }
			  }
			}
          },
          "required": [
            "personalia"
      	  ]
        },
        "driftsinformasjon": {
          "type": "string"
        },
        "kompatibilitet": {
          "title": "Liste med kompatibilitetstekster",
          "description": "Det er et MÅ-krav å vise saksbehandler alle kompatibilitetstekster for versjonen man parser soknads-JSON-en med. Det anbefales å ha et avsnitt (eller tilsvarende) mellom hver enkelt kompatibilitetstekst.",
          "type": "array",
          "items": {
            "$ref": "#/definitions/kompatibilitet"
          }
        }
      },
      "required": [
        "version", "data", "driftsinformasjon", "kompatibilitet"
      ]
    },
    
    "kompatibilitet": {
      "title": "Inneholder en Markdown-formatert kompatibilitetstekst.",
      "description": "Kompatibilitetsteksten skal vises saksbehandler gitt at versjonen man forventer ved parsing av JSON er innenfor intervallet bestemt av \"minVersion\" og \"maxVersion\".",
      "type": "object",
      "properties": {
        "minVersion": {
          "title": "Minimumsversjon for å vise kompatibilitetsteksten (inclusive).",
          "type": "string"
        },
        "maxVersion": {
          "title": "Maksimumsversjon for å vise kompatibilitetsteksten (inclusive).",
          "type": "string"
        },
        "text": {
          "title": "Markdown-formatert tekststreng som kan vises saksbehandler.",
          "type": "string"
        }
      }
    }
  },

  "$ref": "#/definitions/soknad"
}